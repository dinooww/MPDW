---
title: "Tugas Pertemuan 4"
author: Sabitala Dinika G1401231089
output:
  rmdformats::readthedown
---

# White Noise

```{r}
set.seed(1089)
wn <- rnorm(300)
ts.plot(wn)
```

# MA(2)
## Pembangkitan

Akan dicoba membangkitkan proses MA(2) dengan $\theta_1 = 0.4$ dan $\theta_2 = 0.6$  sebanyak 300 observasi.

Nilai-nilai selanjutnya dapat dicari melalui *loop*. Bentuk loop dapat dilihat dari rumus MA(2) yang hendak dibangkitkan:

$$
y_t = e_t+0.4e_{t-1}+0.6e_{t-2}
$$

```{r}
set.seed(1089)
ma <- c(1:300)
ma[1] <- wn[1]
ma[2] <- ma[2] - 0.4 * ma[1]
```

```{r}
for(i in 3:300){
   ma[i] <- wn[i] - 0.4 * wn[i - 1] - 0.6 * wn[i - 2]
}
ma
```

Selain menggunakan cara di atas, pembangkitan proses MA(2) dapat dilakukan dengan fungsi `arima.sim()` sebagai berikut.

```{r}
ma2 <- arima.sim(list(order=c(0,0,2), ma=c(0.4, 0.6)), n=300)
ma2
```

## Karakteristik MA(2)

### Plot Time Series

```{r}
ts.plot(ma)
```

Berdasarkan plot time series, terlihat bahwa data MA(2) yang dibangkitkan stasioner dalam rataan

### Plot ACF

```{r}
acf(ma,lag.max = 20)
```

Berdasarkan plot ACF tersebut, terlihat bahwa plot ACF *cuts off* di lag kedua.

### Plot PACF

```{r}
pacf(ma)
```

Berdasarkan plot PACF tersebut, terlihat bahwa plot PACF cenderung *tails off* dan membentuk gelombang lembah karena nilai theta adalah positif.

### Plot EACF

```{r}
TSA::eacf(ma)
```

Berdasarkan pola segitiga nol pada plot EACF, terlihat bahwa segitiga nol berada pada ordo AR(0) dan ordo MA(2)

## Scatterplot Antar Lag

### Korelasi antara $Y_t$ dengan $Y_{t-1}$

```{r}
yt_ma <- ma[-1]
yt_ma

yt_1_ma <- ma[-300]
yt_1_ma
```

```{r}
plot(y=yt_ma,x=yt_1_ma)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan yang cenderung negatif antara $Y_t$ dengan $Y_{t-1}$. Hal ini sesuai dengan teori yang ada

```{r}
cor(yt_ma,yt_1_ma)
```

Korelasi antara $Y_t$ dengan $Y_{t-1}$ dari hasil simulasi mendekati perhitungan teoritis yaitu

$$
\rho_1=\frac{-\theta_1+\theta_1\theta_2}{1+\theta_1^2+\theta_2^2}=\frac{-0.4+0.4\times0.6}{1+0.4^2+0.6^2}=-0.105
$$

### Korelasi antara $Y_t$ dengan $Y_{t-2}$

```{r}
yt_ma2 <- ma[-c(1,2)]
yt_ma2

yt_2_ma <- ma[-c(299,300)]
yt_2_ma
```

```{r}
plot(y=yt_ma2,x=yt_2_ma)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan cenderung negatif antara $Y_t$ dengan $Y_{t-2}$.

```{r}
cor(yt_ma2,yt_2_ma)
```

Korelasi antara $Y_t$ dengan $Y_{t-2}$ hasil simulasi mendekati teori yang ada yaitu:

$$
\rho_2=\frac{-\theta_2}{1+\theta_1^2+\theta_2^2}=\frac{-0.6}{1+0.4^2+0.6^2}=-0.394
$$

### Korelasi antara $Y_t$ dengan $Y_{t-3}$

```{r}
yt_ma3 <- ma[-c(1,2,3)]
yt_ma3

yt_3_ma <- ma[-c(288, 299,300)]
yt_3_ma
```

```{r}
plot(y=yt_ma3,x=yt_3_ma)
```

Berdasarkan scatterplot tersebut, terlihat bahwa $Y_t$ dan $Y_{t-3}$ menunjukkan pola yang tidak beraturan atau tidak berpola.

```{r}
cor(yt_ma3,yt_3_ma)
```

Korelasi antara $Y_t$ dengan $Y_{t-3}$ dari hasil simulasi juga belum mendekati nilai teoritis yang menyatakan bahwa $\rho_k=0$ untuk k>q.


# AR(2)

## Pembangkitan

Akan dicoba membangkitkan proses AR(2) dengan $\phi_1 = 0.5$ dan $\phi_2 = 0.2$ sebanyak 300 observasi.

Nilai-nilai selanjutnya dapat dicari melalui *loop*. Bentuk loop dapat dilihat dari rumus AR(2) yang hendak dibangkitkan:

$$ Y_t = e_t+0.5Y_{t-1}+0.2Y_{t-2} $$

```{r}
set.seed(1089)
ar <- c(1:300)
ar[1] <- wn[1]
ar[2] <- wn[2] + 0.5 * ar[1]
```

```{r}
for (i in 3:300) {
  ar[i] <- wn[i] + 0.5 * ar[i-1] + 0.2 * ar[i-2]
}
ar
```

Selain menggunakan cara di atas, pembangkitan proses AR dapat dilakukan dengan fungsi `arima.sim()` sebagai berikut.

```{r}
ar2 <- arima.sim(list(order=c(2,0,0), ar=c(0.5,0.2)), n=300)
ar2
```

## Karakteristik AR(2)

### Plot Time Series

```{r}
ts.plot(ar)
```

Berdasarkan plot time series tersebut terlihat bahwa data cenderung stasioner pada rataan

### Plot ACF

```{r}
acf(ar)
```

Berdasarkan plot ACF tersebut terlihat bahwa plot ACF cenderung *tails off*.

### Plot PACF

```{r}
pacf(ar)
```

Berdasarkan plot PACF tersebut, terlihat bahwa plot PACF *cuts off* pada lag kedua.

### Plot EACF

```{r}
TSA::eacf(ar)
```

Berdasarkan pola segitiga nol pada plot EACF, terlihat bahwa segitiga nol berada pada ordo AR(0) dan ordo MA(7)

## Scatterplot Antar Lag

### Korelasi antara $Y_t$ dengan $Y_{t-1}$

```{r}
yt_ar <- ar[-1]
yt_ar

yt_1_ar <- ar[-300]
yt_1_ar
```

```{r}
plot(y=yt_ar,x=yt_1_ar)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_{t-1}$. Hal ini sesuai dengan teori yang ada

```{r}
cor(yt_ar,yt_1_ar)
```

Korelasi antara $Y_t$ dengan $Y_{t-1}$ dari hasil simulasi mendekati perhitungan teoritis yaitu

$$
\rho_1=\frac{\phi_1}{1-\phi_2}=\frac{0.5}{1-0.2}=0.625
$$

### Korelasi antara $Y_t$ dengan $Y_{t-2}$

```{r}
yt_ar2 <- ar[-c(1,2)]
yt_ar2

yt_2_ar <- ar[-c(299,300)]
yt_2_ar
```

```{r}
plot(y=yt_ar2,x=yt_2_ar)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_{t-2}$. Hal ini sesuai dengan teori yang ada

```{r}
cor(yt_ar2,yt_2_ar)
```

Korelasi antara $Y_t$ dengan $Y_{t-2}$ dari hasil simulasi mendekati perhitungan teoritis yaitu :

$$
\rho_2=\phi_1\rho_{k-1}+\phi_2\rho_{k-2}=\frac{\phi_2(1-\phi_2)+\phi_1^2}{1-\phi_2}=\frac{0.2(1-0.2)+0.5^2}{1-0.2}=0.5125
$$

### Korelasi antara $Y_t$ dengan $Y_{t-3}$

```{r}
yt_ar3 <- ar[-c(1,2,3)]
yt_ar3

yt_3_ar <- ar[-c(298,299,300)]
yt_3_ar
```

```{r}
plot(y=yt_ar3,x=yt_3_ar)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif yang lemah antara $Y_t$ dengan $Y_{t-3}$.

```{r}
cor(yt_ar3,yt_3_ar)
```

Korelasi antara $Y_t$ dengan $Y_{t-3}$ dari hasil simulasi sedkit mendekati perhitungan teoritis yaitu :

$$
\rho_3=\phi_1\rho_{k-1}+\phi_2\rho_{k-2}=\phi_1\rho_2+\phi_2\rho_1=0.5\times0.5125+0.2\times0.625=0.38125
$$

# ARMA(2,2)

## Pembangkitan

Bentuk umum data berpola ARMA:

$$
y_{t} = \sum_{i=1}^p \phi_{i}y_{t-i} + \sum_{j=1}^q \theta_j e_{t-j}+ e_{t}
$$

Dalam kasus ini, akan dibangkitkan suatu data dengan model ARMA(2,2) sebanyak 300 data yang memiliki nilai $\phi_1 = 0.5$ dan $\phi_2 = 0.2$ serta $\theta_1 = 0.4$ dan $\theta_2 = 0.6$. Rumusan model tersebut adalah sebagai berikut:

$$ Y_t = 0.5Y_{t-1}+0.2Y_{t-2}+0.4_{t-1}+0.6_{t-2}+e_t $$
```{r}
set.seed(1089)
phi1 = 0.5
phi2 = 0.2
theta1 = 0.4
theta2 = 0.6

y.arma=c(1:300)
for (i in 3:300){y.arma[i] = phi1*y.arma[i-1] + phi2*y.arma[i-2] +
                 wn[i] - theta1*wn[i-1] - theta2*wn[i-2]}
y.arma
```

Pembangkitan ARMA(p,q) juga dapat dilakukan dengan fungsi `arima.sim` sebagai berikut.

```{r}
arma11 <- arima.sim(list(order=c(1,0,1), ar = 0.7, ma = 0.5), n=300)
arma11
```

## Karakteristik ARMA(2,2)

### Plot Time Series

```{r}
ts.plot(y.arma)
```

Berdasarkan plot time series tersebut, terlihat bahwa model ARMA(2,2) cenderung stasioner dalam rataan

### Plot ACF

```{r}
acf(y.arma)
```

Berdasarkan plot ACF tersebut, terlihat bahwa model ARMA(2,2) hasil simulasi memiliki plot ACF yang *tails off*

### Plot PACF

```{r}
pacf(y.arma)
```

Berdasarkan plot PACF tersebut, terlihat bahwa model ARMA(2,2) hasil simulasi memiliki plot PACF yang *tails off*

### Plot EACF

```{r}
TSA::eacf(y.arma)
```

Berdasarkan pola segitiga nol pada plot EACF, terlihat bahwa segitiga nol berada pada ordo AR(0) dan ordo MA(2)

## Scatterplot Antar Lag

### Korelasi antara $Y_t$ dengan $Y_{t-1}$

```{r}
yt_arma <- y.arma[-1]
yt_arma

yt_1_arma <- y.arma[-300]
yt_1_arma
```

```{r}
plot(y=yt_arma,x=yt_1_arma)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan yang cenderung positif antara $Y_t$ dengan $Y_{t-1}$.

```{r}
cor(yt_arma,yt_1_arma)
```

### Korelasi antara $Y_t$ dengan $Y_{t-2}$

```{r}
yt_arma <- y.arma[-c(1,2)]
yt_arma

yt_2_arma <- y.arma[-c(299,300)]
yt_2_arma
```

```{r}
plot(y=yt_arma,x=yt_2_arma)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan yang cenderung negatif antara $Y_t$ dengan $Y_{t-2}$.

### Korelasi antara $Y_t$ dengan $Y_{t-3}$

```{r}
yt_arma <- y.arma[-c(1,2,3)]
yt_arma

yt_3_arma <- y.arma[-c(298,299,300)]
yt_3_arma
```

```{r}
plot(y=yt_arma,x=yt_3_arma)
```

Berdasarkan scatterplot tersebut, terlihat bahwa tidak terlihat adanya pola hubungan yang jelas antara $Y_t$ dengan $Y_{t-3}$.

```{r}
cor(yt_arma,yt_3_arma)
```

## Perhitungan Autokorelasi Secara Teoritis

Untuk model ARMA(2,2):

$$
Y_t = \phi_1 Y_{t-1} + \phi_2 Y_{t-2} + \varepsilon_t + \theta_1 \varepsilon_{t-1} + \theta_2 \varepsilon_{t-2}, 
\quad \text{dengan } \operatorname{Var}(\varepsilon_t)=\sigma^2
$$

Sistem persamaan autokovarian $\gamma_k = \operatorname{Cov}(Y_t, Y_{t-k})$ :

$$
\begin{aligned}
\gamma_0 &= \phi_1 \gamma_1 + \phi_2 \gamma_2 + \sigma^2(1+\theta_1^2+\theta_2^2), \\
\gamma_1 &= \phi_1 \gamma_0 + \phi_2 \gamma_1 + \sigma^2(\theta_1+\theta_1\theta_2), \\
\gamma_2 &= \phi_1 \gamma_1 + \phi_2 \gamma_0 + \sigma^2 \theta_2, \\
\gamma_3 &= \phi_1 \gamma_2 + \phi_2 \gamma_1.
\end{aligned}
$$

Substitusi parameter $\phi_1=0.5, \phi_2=0.2, \theta_1=0.4, \theta_2=0.6, \sigma^2=1$ :

$$
\begin{aligned}
\gamma_0 &= 0.5\gamma_1 + 0.2\gamma_2 + 1.52, \\
\gamma_1 &= 0.5\gamma_0 + 0.2\gamma_1 + 0.64, \\
\gamma_2 &= 0.5\gamma_1 + 0.2\gamma_0 + 0.6, \\
\gamma_3 &= 0.5\gamma_2 + 0.2\gamma_1.
\end{aligned}
$$

Hasil penyelesaian sistem linear :

$$
\gamma_0 \approx 3.624, \quad 
\gamma_1 \approx 3.065, \quad 
\gamma_2 \approx 2.857, \quad 
\gamma_3 \approx 2.042.
$$

Autokorelasi teoritis $\rho_k = \frac{\gamma_k}{\gamma_0}, \quad k \geq 0$ :

$$
\begin{aligned}
\rho_1 &= \frac{\gamma_1}{\gamma_0} \approx 0.846, \\
\rho_2 &= \frac{\gamma_2}{\gamma_0} \approx 0.788, \\
\rho_3 &= \frac{\gamma_3}{\gamma_0} \approx 0.563.
\end{aligned}
$$

